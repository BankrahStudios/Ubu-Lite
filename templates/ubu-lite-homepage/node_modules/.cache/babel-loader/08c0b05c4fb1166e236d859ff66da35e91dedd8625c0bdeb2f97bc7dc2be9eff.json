{"ast":null,"code":"import React,{useEffect,useState}from'react';import{api}from'../api';import{getToken,getUser}from'../auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Messages=()=>{var _getUser;const[bookingId,setBookingId]=useState('');const[items,setItems]=useState([]);const[text,setText]=useState('');const[error,setError]=useState(null);const load=async()=>{setError(null);const token=getToken();if(!token){setError('Login required');return;}try{const data=await api.listMessages(bookingId,token);setItems(Array.isArray(data)?data:[]);}catch(e){setError(e.message);}};const send=async()=>{setError(null);const token=getToken();if(!token){setError('Login required');return;}try{await api.sendMessage(bookingId,{text},token);setText('');await load();}catch(e){setError(e.message);}};useEffect(()=>{if(bookingId)load();},[bookingId]);return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:800,margin:'30px auto'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Messages\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Booking ID\",value:bookingId,onChange:e=>setBookingId(e.target.value),className:\"input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:load,children:\"Load\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red',marginTop:10},children:error}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,minHeight:120,border:'1px solid #eee',padding:8},children:[items.map(m=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:6,borderBottom:'1px solid #f3f3f3'},children:[/*#__PURE__*/_jsx(\"b\",{children:m.sender_name||m.sender||'User'}),\": \",m.text]},m.id)),!items.length&&/*#__PURE__*/_jsx(\"div\",{children:\"No messages yet.\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,marginTop:10},children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Message as \".concat(((_getUser=getUser())===null||_getUser===void 0?void 0:_getUser.username)||'guest'),value:text,onChange:e=>setText(e.target.value),className:\"input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:send,children:\"Send\"})]})]});};export default Messages;","map":{"version":3,"names":["React","useEffect","useState","api","getToken","getUser","jsx","_jsx","jsxs","_jsxs","Messages","_getUser","bookingId","setBookingId","items","setItems","text","setText","error","setError","load","token","data","listMessages","Array","isArray","e","message","send","sendMessage","style","maxWidth","margin","children","display","gap","placeholder","value","onChange","target","className","onClick","color","marginTop","minHeight","border","padding","map","m","borderBottom","sender_name","sender","id","length","concat","username"],"sources":["C:/Users/Kojos/OneDrive/Desktop/Ubu-Lite/templates/ubu-lite-homepage/src/pages/Messages.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { api } from '../api';\nimport { getToken, getUser } from '../auth';\n\nconst Messages: React.FC = () => {\n  const [bookingId, setBookingId] = useState('');\n  const [items, setItems] = useState<any[]>([]);\n  const [text, setText] = useState('');\n  const [error, setError] = useState<string | null>(null);\n\n  const load = async () => {\n    setError(null);\n    const token = getToken();\n    if (!token) { setError('Login required'); return; }\n    try {\n      const data = await api.listMessages(bookingId, token);\n      setItems(Array.isArray(data) ? data : []);\n    } catch (e:any) { setError(e.message); }\n  };\n\n  const send = async () => {\n    setError(null);\n    const token = getToken();\n    if (!token) { setError('Login required'); return; }\n    try {\n      await api.sendMessage(bookingId, { text }, token);\n      setText('');\n      await load();\n    } catch (e:any) { setError(e.message); }\n  };\n\n  useEffect(() => { if (bookingId) load(); }, [bookingId]);\n\n  return (\n    <div style={{ maxWidth: 800, margin: '30px auto' }}>\n      <h2>Messages</h2>\n      <div style={{ display: 'flex', gap: 8 }}>\n        <input placeholder=\"Booking ID\" value={bookingId} onChange={e=>setBookingId(e.target.value)} className=\"input\" />\n        <button className=\"btn\" onClick={load}>Load</button>\n      </div>\n      {error && <div style={{ color: 'red', marginTop: 10 }}>{error}</div>}\n      <div style={{ marginTop: 12, minHeight: 120, border: '1px solid #eee', padding: 8 }}>\n        {items.map((m:any) => (\n          <div key={m.id} style={{ padding: 6, borderBottom: '1px solid #f3f3f3' }}>\n            <b>{m.sender_name || m.sender || 'User'}</b>: {m.text}\n          </div>\n        ))}\n        {!items.length && <div>No messages yet.</div>}\n      </div>\n      <div style={{ display: 'flex', gap: 8, marginTop: 10 }}>\n        <input placeholder={`Message as ${getUser()?.username || 'guest'}`} value={text} onChange={e=>setText(e.target.value)} className=\"input\" />\n        <button className=\"btn\" onClick={send}>Send</button>\n      </div>\n    </div>\n  );\n};\n\nexport default Messages;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}