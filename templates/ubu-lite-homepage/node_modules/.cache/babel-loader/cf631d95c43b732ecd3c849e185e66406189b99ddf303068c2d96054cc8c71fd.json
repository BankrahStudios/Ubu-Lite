{"ast":null,"code":"import React,{useEffect,useMemo,useState}from'react';import{useHistory}from'react-router-dom';import{api}from'../api';import GigCard from'../components/GigCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Marketplace=()=>{const[services,setServices]=useState([]);const[creatives,setCreatives]=useState([]);const[q,setQ]=useState('');const[cat,setCat]=useState('');const[minPrice,setMinPrice]=useState('');const[maxPrice,setMaxPrice]=useState('');const history=useHistory();useEffect(()=>{api.listServices().then(setServices).catch(()=>setServices([]));api.listCreatives().then(setCreatives).catch(()=>setCreatives([]));},[]);const categories=useMemo(()=>{const set=new Set();services.forEach(s=>s.category&&set.add(String(s.category)));return Array.from(set).sort();},[services]);const creativeById=useMemo(()=>{const map=new Map();creatives.forEach(c=>{var _c$user;return map.set(String(c.id),((_c$user=c.user)===null||_c$user===void 0?void 0:_c$user.username)||c.username||'Creative');});return map;},[creatives]);const filtered=useMemo(()=>{const min=minPrice?parseFloat(minPrice):-Infinity;const max=maxPrice?parseFloat(maxPrice):Infinity;return services.filter(s=>{const matchQ=q?(s.title||'').toLowerCase().includes(q.toLowerCase())||(s.description||'').toLowerCase().includes(q.toLowerCase()):true;const matchCat=cat?String(s.category||'').toLowerCase()===cat.toLowerCase():true;const price=typeof s.price==='number'?s.price:Number(s.price||0);const matchPrice=price>=min&&price<=max;return matchQ&&matchCat&&matchPrice;});},[services,q,cat,minPrice,maxPrice]);return/*#__PURE__*/_jsxs(\"div\",{className:\"market\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"market-toolbar\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input\",placeholder:\"What service are you looking for?\",value:q,onChange:e=>setQ(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{className:\"input\",value:cat,onChange:e=>setCat(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All categories\"}),categories.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c,children:c},c))]}),/*#__PURE__*/_jsx(\"input\",{className:\"input\",placeholder:\"Min price\",value:minPrice,onChange:e=>setMinPrice(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{className:\"input\",placeholder:\"Max price\",value:maxPrice,onChange:e=>setMaxPrice(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>{setQ('');setCat('');setMinPrice('');setMaxPrice('');},children:\"Reset\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"market-grid\",children:[filtered.map(s=>/*#__PURE__*/_jsx(GigCard,{title:s.title,price:typeof s.price==='number'?s.price:Number(s.price||0),category:String(s.category||''),seller:creativeById.get(String(s.creative||s.creative_profile||'')),rating:typeof s.rating==='number'?s.rating:undefined,imageUrl:s.image_url,onClick:()=>history.push(\"/services/\".concat(s.id))},s.id)),!filtered.length&&/*#__PURE__*/_jsx(\"div\",{className:\"market-empty\",children:\"No gigs match your filters.\"})]})]});};export default Marketplace;","map":{"version":3,"names":["React","useEffect","useMemo","useState","useHistory","api","GigCard","jsx","_jsx","jsxs","_jsxs","Marketplace","services","setServices","creatives","setCreatives","q","setQ","cat","setCat","minPrice","setMinPrice","maxPrice","setMaxPrice","history","listServices","then","catch","listCreatives","categories","set","Set","forEach","s","category","add","String","Array","from","sort","creativeById","map","Map","c","_c$user","id","user","username","filtered","min","parseFloat","Infinity","max","filter","matchQ","title","toLowerCase","includes","description","matchCat","price","Number","matchPrice","className","children","placeholder","value","onChange","e","target","onClick","seller","get","creative","creative_profile","rating","undefined","imageUrl","image_url","push","concat","length"],"sources":["C:/Users/Kojos/OneDrive/Desktop/Ubu-Lite/templates/ubu-lite-homepage/src/pages/Marketplace.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { api } from '../api';\nimport GigCard from '../components/GigCard';\n\ntype Service = {\n  id: number;\n  title: string;\n  description?: string;\n  category?: string;\n  price?: number;\n  creative?: number | string;\n  creative_profile?: number | string;\n  image_url?: string;\n  rating?: number;\n};\n\ntype Creative = { id: number; user?: { username?: string }; username?: string };\n\nconst Marketplace: React.FC = () => {\n  const [services, setServices] = useState<Service[]>([]);\n  const [creatives, setCreatives] = useState<Creative[]>([]);\n  const [q, setQ] = useState('');\n  const [cat, setCat] = useState('');\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const history = useHistory();\n\n  useEffect(() => {\n    api.listServices().then(setServices).catch(()=>setServices([]));\n    api.listCreatives().then(setCreatives).catch(()=>setCreatives([]));\n  }, []);\n\n  const categories = useMemo(() => {\n    const set = new Set<string>();\n    services.forEach(s => s.category && set.add(String(s.category)));\n    return Array.from(set).sort();\n  }, [services]);\n\n  const creativeById = useMemo(() => {\n    const map = new Map<string, string>();\n    creatives.forEach(c => map.set(String(c.id), c.user?.username || c.username || 'Creative'));\n    return map;\n  }, [creatives]);\n\n  const filtered = useMemo(() => {\n    const min = minPrice ? parseFloat(minPrice) : -Infinity;\n    const max = maxPrice ? parseFloat(maxPrice) : Infinity;\n    return services.filter(s => {\n      const matchQ = q ? (\n        (s.title || '').toLowerCase().includes(q.toLowerCase()) ||\n        (s.description || '').toLowerCase().includes(q.toLowerCase())\n      ) : true;\n      const matchCat = cat ? (String(s.category || '').toLowerCase() === cat.toLowerCase()) : true;\n      const price = typeof s.price === 'number' ? s.price : Number(s.price || 0);\n      const matchPrice = price >= min && price <= max;\n      return matchQ && matchCat && matchPrice;\n    });\n  }, [services, q, cat, minPrice, maxPrice]);\n\n  return (\n    <div className=\"market\">\n      <div className=\"market-toolbar\">\n        <input className=\"input\" placeholder=\"What service are you looking for?\" value={q} onChange={e=>setQ(e.target.value)} />\n        <select className=\"input\" value={cat} onChange={e=>setCat(e.target.value)}>\n          <option value=\"\">All categories</option>\n          {categories.map(c => <option key={c} value={c}>{c}</option>)}\n        </select>\n        <input className=\"input\" placeholder=\"Min price\" value={minPrice} onChange={e=>setMinPrice(e.target.value)} />\n        <input className=\"input\" placeholder=\"Max price\" value={maxPrice} onChange={e=>setMaxPrice(e.target.value)} />\n        <button className=\"btn\" onClick={()=>{setQ(''); setCat(''); setMinPrice(''); setMaxPrice('')}}>Reset</button>\n      </div>\n\n      <div className=\"market-grid\">\n        {filtered.map(s => (\n          <GigCard\n            key={s.id}\n            title={s.title}\n            price={typeof s.price === 'number' ? s.price : Number(s.price || 0)}\n            category={String(s.category || '')}\n            seller={creativeById.get(String(s.creative || s.creative_profile || ''))}\n            rating={typeof s.rating === 'number' ? s.rating : undefined}\n            imageUrl={s.image_url}\n            onClick={() => history.push(`/services/${s.id}`)}\n          />\n        ))}\n        {!filtered.length && (\n          <div className=\"market-empty\">No gigs match your filters.</div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Marketplace;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}